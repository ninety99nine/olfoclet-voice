import{L as x}from"./Logo-CEFCQWTC.js";import{I as b}from"./Input-Ce6sOWCE.js";import{B as y}from"./Button-QuQuG-sh.js";import{c,a as e,d as a,r as n,i as S,b as _,t as d,w as u,j as P,o as w,e as v}from"./app-Du355Hwa.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./createLucideIcon-CQR3ABw7.js";import"./Tooltip-Bh561etO.js";import"./mail-CmabDzCr.js";const k={name:"ResetPassword",components:{Logo:x,Input:b,Button:y},inject:["formState","notificationState"],data(){return{form:{email:"",token:"",password:"",confirmPassword:""},loading:!1,currentYear:new Date().getFullYear()}},methods:{async submit(){var m,t;if(!this.loading&&(this.formState.hideFormErrors(),this.form.email.trim()===""&&this.formState.setFormError("email","Email is required"),this.form.password.trim()===""&&this.formState.setFormError("password","New Password is required"),this.form.confirmPassword.trim()===""&&this.formState.setFormError("confirmPassword","Confirm New Password is required"),this.form.password!==this.form.confirmPassword&&this.formState.setFormError("confirmPassword","Passwords do not match"),!this.formState.hasErrors)){this.loading=!0;try{await P.post("/api/auth/reset-password",this.form),this.notificationState.showSuccessNotification("Password reset successfully. Please log in with your new password."),this.$router.push({name:"login"})}catch(o){const f=((t=(m=o==null?void 0:o.response)==null?void 0:m.data)==null?void 0:t.message)||(o==null?void 0:o.message)||"Something went wrong while resetting your password";this.formState.setServerFormErrors(o),this.notificationState.showWarningNotification(f),console.error("Failed to reset password:",o)}finally{this.loading=!1}}}},mounted(){this.form.email=this.$route.query.email||"",this.form.token=this.$route.query.token||"",(!this.form.email||!this.form.token)&&(this.formState.setFormError("general","Invalid or missing email/token."),this.notificationState.showWarningNotification("Invalid or missing email/token."))}},V={class:"min-h-screen grid grid-cols-1 lg:grid-cols-2 transition-opacity opacity-100 duration-750 lg:grow starting:opacity-0"},F={class:"flex items-center justify-center p-6 bg-slate-100"},N={class:"w-full max-w-md"},T={class:"flex justify-center mb-6"},B={class:"bg-white rounded-lg shadow-sm border border-slate-200 p-6 mb-6"},j={key:0,class:"text-red-500 text-sm mb-3"},C={class:"ml-1"},I={class:"flex justify-center mt-4"},q={class:"text-sm text-center text-gray-500"};function L(m,t,o,f,r,s){const g=n("Logo"),l=n("Input"),p=n("Button"),h=n("router-link");return w(),c("div",V,[e("div",F,[e("div",N,[e("div",T,[a(g,{height:"h-10"})]),e("div",B,[t[5]||(t[5]=e("h1",{class:"text-2xl font-semibold leading-none tracking-tight mb-4"},"Reset Password",-1)),t[6]||(t[6]=e("h1",{class:"text-sm text-gray-500 mb-4"},"Enter a new password for your account.",-1)),e("form",{onSubmit:t[3]||(t[3]=S((...i)=>s.submit&&s.submit(...i),["prevent"])),class:"space-y-4"},[a(l,{type:"email",label:"Email",modelValue:r.form.email,"onUpdate:modelValue":t[0]||(t[0]=i=>r.form.email=i),errorText:s.formState.getFormError("email"),disabled:""},null,8,["modelValue","errorText"]),a(l,{type:"password",label:"New Password",modelValue:r.form.password,"onUpdate:modelValue":t[1]||(t[1]=i=>r.form.password=i),errorText:s.formState.getFormError("password")},null,8,["modelValue","errorText"]),a(l,{type:"password",label:"Confirm New Password",modelValue:r.form.confirmPassword,"onUpdate:modelValue":t[2]||(t[2]=i=>r.form.confirmPassword=i),errorText:s.formState.getFormError("confirmPassword")},null,8,["modelValue","errorText"]),s.formState.generalErrorText?(w(),c("div",j,d(s.formState.generalErrorText),1)):_("",!0),a(p,{size:"md",type:"primary",class:"w-full",action:s.submit,disabled:r.loading},{default:u(()=>[e("span",C,d(r.loading?"Resetting...":"Reset Password"),1)]),_:1},8,["action","disabled"]),e("div",I,[a(h,{to:{name:"login"},class:"text-sm text-blue-600 hover:underline"},{default:u(()=>t[4]||(t[4]=[v("Back to Login")])),_:1})])],32)]),e("p",q,"Â© "+d(r.currentYear)+" Telcoflo. All rights reserved.",1)])]),t[7]||(t[7]=e("div",{class:"hidden lg:block"},[e("img",{src:"/images/smiling-customer-service-agent.jpg",class:"w-full h-full object-cover",alt:"Customer service agent"})],-1))])}const G=E(k,[["render",L]]);export{G as default};
