import{i as S,m as w,w as f,r as u,o as d,a as o,h as Y,c as a,b as y,I as T,aj as j,ad as F,d as r,e as v,F as N,t as x,l as V,n as C}from"./app-Bh0CRPT1.js";import{B as z}from"./Button-D-J7vJoA.js";import{I as U}from"./Input-DLLHQFCa.js";import{M as P,S as Q,P as ae,T as ce,i as G,a as K}from"./Table-C-dAgqL-.js";import{_ as A}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{f as ue,D as pe}from"./dateUtils-BHWJh6Nr.js";import{c as M}from"./createLucideIcon-C9p8Jo51.js";import{L as D}from"./mail-D1Pe_K0u.js";import{P as $}from"./plus-YFJMpCfm.js";import{V as ee}from"./vue-draggable-next.esm-bundler-C0JoXrCN.js";import{X as me}from"./x-B22kpjHy.js";import{C as he}from"./check-BF-T3jQ7.js";import{F as fe}from"./file-text-Cj8aqMCN.js";import{P as ge}from"./pencil-DHfiUf6s.js";import{L as be}from"./library-big-BBdcI3he.js";import{A as ye}from"./arrow-left-dZ87ko9V.js";import"./Tooltip-CP6j0BUe.js";import"./Drawer-Bx9DDrOI.js";import"./arrow-up-Q9vzLiuS.js";import"./Switch-kMwrpPJn.js";/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=M("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=M("earth",[["path",{d:"M21.54 15H17a2 2 0 0 0-2 2v4.54",key:"1djwo0"}],["path",{d:"M7 3.34V5a3 3 0 0 0 3 3a2 2 0 0 1 2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2c0-1.1.9-2 2-2h3.17",key:"1tzkfa"}],["path",{d:"M11 21.95V18a2 2 0 0 0-2-2a2 2 0 0 1-2-2v-1a2 2 0 0 0-2-2H2.05",key:"14pb5j"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=M("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=M("folder-plus",[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=M("folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=M("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=M("grip-vertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=M("lock-open",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=M("square-minus",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=M("square-plus",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=M("sticky-note",[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]]),Ae={inject:["formState","notificationState"],components:{Modal:P,Button:z},props:{knowledgeBaseId:{type:String,required:!0}},data(){return{form:{type:"website",name:"",content:"",knowledge_base_id:this.knowledgeBaseId}}},methods:{showModal(n=null){n&&(this.form.type=n),this.$refs.modal.showModal()},closeModal(){this.$refs.modal.closeModal(),this.form.name="",this.form.content=""},async submit(){var n,e;try{this.formState.isLoading=!0,await S.post("/api/content-sources",this.form),this.notificationState.showSuccessNotification("Source added successfully."),this.$emit("created"),this.closeModal()}catch(s){const i=((e=(n=s==null?void 0:s.response)==null?void 0:n.data)==null?void 0:e.message)||(s==null?void 0:s.message)||"Failed to add source";this.notificationState.showWarningNotification(i),console.error("Failed to add source:",s)}finally{this.formState.isLoading=!1}}}},Ie={key:0},Me={key:1},Te={class:"flex justify-end space-x-2"};function Ve(n,e,s,i,t,l){const c=u("Button"),p=u("Modal");return d(),w(p,{ref:"modal",title:"Add Source",size:"md"},{default:f(()=>[o("form",{onSubmit:e[4]||(e[4]=Y((...m)=>l.submit&&l.submit(...m),["prevent"])),class:"space-y-4"},[o("div",null,[e[6]||(e[6]=o("label",{for:"type",class:"block text-sm font-medium text-gray-700"},"Type",-1)),T(o("select",{id:"type","onUpdate:modelValue":e[0]||(e[0]=m=>t.form.type=m),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},e[5]||(e[5]=[o("option",{value:"website"},"Website",-1),o("option",{value:"snippet"},"Snippet",-1)]),512),[[j,t.form.type]])]),t.form.type==="website"?(d(),a("div",Ie,[e[7]||(e[7]=o("label",{for:"name",class:"block text-sm font-medium text-gray-700"},"URL",-1)),T(o("input",{id:"name",type:"text","onUpdate:modelValue":e[1]||(e[1]=m=>t.form.name=m),placeholder:"https://example.com",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[F,t.form.name]])])):y("",!0),t.form.type==="snippet"?(d(),a("div",Me,[e[8]||(e[8]=o("label",{for:"name",class:"block text-sm font-medium text-gray-700"},"Title",-1)),T(o("input",{id:"name",type:"text","onUpdate:modelValue":e[2]||(e[2]=m=>t.form.name=m),placeholder:"Snippet Title",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[F,t.form.name]]),e[9]||(e[9]=o("label",{for:"content",class:"block text-sm font-medium text-gray-700"},"Content",-1)),T(o("textarea",{id:"content","onUpdate:modelValue":e[3]||(e[3]=m=>t.form.content=m),rows:"4",placeholder:"Snippet Content",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[F,t.form.content]])])):y("",!0),o("div",Te,[r(c,{type:"light",size:"sm",action:l.closeModal},{default:f(()=>e[10]||(e[10]=[v("Cancel")])),_:1},8,["action"]),r(c,{type:"primary",size:"sm",loading:l.formState.isLoading},{default:f(()=>e[11]||(e[11]=[v("Add")])),_:1},8,["loading"])])],32)]),_:1},512)}const ze=A(Ae,[["render",Ve]]),Ee={inject:["notificationState"],components:{Input:U,Button:z,AddSourceModal:ze,BookOpen:Z},props:{knowledgeBaseId:{type:String,required:!0}},data(){return{Plus:$,BookOpen:Z,Lock:D,Globe:ke,MoreHorizontal:_e,publicArticlesEnabled:!1,publicArticlesCount:0,internalArticlesEnabled:!1,internalArticlesCount:0,snippetsEnabled:!1,snippetsCount:0,websites:[],lastSyncedAt:null,isLoadingSources:!1}},computed:{showSources(){return this.isLoadingSources||this.publicArticlesCount>0||this.internalArticlesCount>0||this.snippetsCount>0||this.websites.length>0}},methods:{formattedRelativeDate:ue,showAddSourceModal(n=null){this.$refs.addSourceModal.showModal(n)},async togglePublicArticles(){this.notificationState.showInfoNotification("Public articles toggling is not implemented in this demo.")},async toggleInternalArticles(){this.notificationState.showInfoNotification("Internal articles toggling is not implemented in this demo.")},async toggleSnippets(){this.notificationState.showInfoNotification("Snippets toggling is not implemented in this demo.")},async toggleWebsite(n){var e,s;try{await S.put(`/api/content-sources/${n.id}`,{enabled:n.enabled}),this.notificationState.showSuccessNotification("Website updated successfully.")}catch(i){n.enabled=!n.enabled;const t=((s=(e=i==null?void 0:i.response)==null?void 0:e.data)==null?void 0:s.message)||(i==null?void 0:i.message)||"Failed to update website";this.notificationState.showWarningNotification(t),console.error("Failed to update website:",i)}},async fetchSources(){var n,e;try{this.isLoadingSources=!0;const i=(await S.get("/api/content-sources",{params:{knowledge_base_id:this.knowledgeBaseId}})).data.data;console.log("sources"),console.log(i),this.publicArticlesEnabled=i.some(t=>t.type==="intercom"&&t.name==="Public Articles"&&t.enabled),this.publicArticlesCount=i.filter(t=>t.type==="intercom"&&t.name==="Public Articles").length,console.log("this.publicArticlesCount"),console.log(this.publicArticlesCount),this.internalArticlesEnabled=i.some(t=>t.type==="intercom"&&t.name==="Internal Articles"&&t.enabled),this.internalArticlesCount=i.filter(t=>t.type==="intercom"&&t.name==="Internal Articles").length,console.log("this.internalArticlesCount"),console.log(this.internalArticlesCount),this.snippetsEnabled=i.some(t=>t.type==="snippet"&&t.enabled),this.snippetsCount=i.filter(t=>t.type==="snippet").length,console.log("this.snippetsCount"),console.log(this.snippetsCount),this.websites=i.filter(t=>t.type==="website"),this.lastSyncedAt=this.websites.length>0?this.websites[0].last_synced_at:null,console.log("this.websites"),console.log(this.websites)}catch(s){const i=((e=(n=s==null?void 0:s.response)==null?void 0:n.data)==null?void 0:e.message)||(s==null?void 0:s.message)||"Something went wrong while fetching sources";this.notificationState.showWarningNotification(i),console.error("Failed to fetch sources:",s)}finally{this.isLoadingSources=!1}}},created(){this.fetchSources()}},Be={class:"select-none space-y-4 sm:space-y-6"},Fe={class:"flex justify-between"},Pe={class:"flex items-end space-x-2"},Ue={class:"flex justify-end"},je={class:"space-y-6"},Le={class:"border rounded-lg p-4 bg-white shadow-sm"},De={class:"flex justify-between items-center mb-2"},Oe={class:"flex items-center space-x-2"},Re={class:"flex items-center space-x-2"},He={class:"text-sm text-gray-600"},qe={class:"flex items-center space-x-2"},We={class:"border rounded-lg p-4 bg-white shadow-sm"},Je={class:"flex justify-between items-center mb-2"},Ge={class:"flex items-center space-x-2"},Ke={class:"flex items-center space-x-2"},Ze={class:"text-sm text-gray-600"},Xe={class:"flex items-center space-x-2"},Ye={class:"border rounded-lg p-4 bg-white shadow-sm"},Qe={class:"flex justify-between items-center mb-2"},$e={class:"flex items-center space-x-2"},et={class:"flex items-center space-x-2"},tt={key:0,class:"text-sm text-gray-600"},st={class:"text-sm text-gray-600"},ot={key:0,class:"text-sm text-gray-600"},nt={class:"border rounded-lg p-4 bg-white shadow-sm"},lt={class:"flex justify-between items-center mb-2"},it={class:"flex items-center space-x-2"},dt={class:"space-y-2"},rt={class:"flex items-center justify-between"},at={class:"flex items-center space-x-2"},ct={class:"flex items-center space-x-2"},ut={class:"text-sm text-gray-600"},pt={class:"flex items-center justify-between"},mt={class:"flex items-center space-x-2"},ht={class:"flex items-center space-x-2"},ft={class:"flex items-center justify-between"},gt={class:"flex items-center space-x-2"},bt={class:"flex items-center space-x-2"},yt={key:1,class:"select-none w-full flex justify-center py-16"},xt={class:"max-w-sm w-full bg-white shadow-sm rounded-xl p-6 flex flex-col items-center text-center space-y-4 border border-dashed border-gray-200"};function _t(n,e,s,i,t,l){const c=u("BookOpen"),p=u("Button"),m=u("Input"),h=u("Lock"),g=u("Globe"),k=u("MoreHorizontal"),E=u("AddSourceModal");return d(),a("div",Be,[l.showSources?(d(),a(N,{key:0},[o("div",Fe,[o("div",Pe,[r(c,{size:"48","stroke-width":"1",class:"text-gray-400"}),e[3]||(e[3]=o("div",null,[o("h2",{class:"text-xl font-semibold text-gray-900 dark:text-white"},"Sources"),o("p",{class:"text-sm text-gray-600 dark:text-neutral-400"}," Manage sources for this knowledge base ")],-1))]),o("div",Ue,[r(p,{type:"primary",size:"md",leftIcon:t.Plus,leftIconSize:"20",action:l.showAddSourceModal},{default:f(()=>e[4]||(e[4]=[o("span",null,"Add Source",-1)])),_:1},8,["leftIcon","action"])])]),o("div",je,[o("div",Le,[o("div",De,[o("div",Oe,[r(c,{size:"24",class:"text-gray-600"}),e[5]||(e[5]=o("div",null,[o("h3",{class:"text-lg font-medium text-gray-900"},"Public articles"),o("p",{class:"text-sm text-gray-500"},"Let AI Agent and Copilot use public articles from your Help Center.")],-1))]),o("div",Re,[o("span",He,x(t.publicArticlesCount)+" "+x(t.publicArticlesCount===1?"article":"articles"),1),r(p,{type:"light",size:"sm",action:()=>l.showAddSourceModal("public_article")},{default:f(()=>e[6]||(e[6]=[v("Add article")])),_:1},8,["action"])])]),o("div",qe,[r(m,{type:"checkbox",modelValue:t.publicArticlesEnabled,"onUpdate:modelValue":e[0]||(e[0]=_=>t.publicArticlesEnabled=_),onChange:l.togglePublicArticles},null,8,["modelValue","onChange"]),e[7]||(e[7]=o("span",{class:"text-sm text-gray-600"},"Intercom",-1))])]),o("div",We,[o("div",Je,[o("div",Ge,[r(h,{size:"24",class:"text-gray-600"}),e[8]||(e[8]=o("div",null,[o("h3",{class:"text-lg font-medium text-gray-900"},"Internal articles"),o("p",{class:"text-sm text-gray-500"},"Give Copilot internal knowledge only available to you and your team.")],-1))]),o("div",Ke,[o("span",Ze,x(t.internalArticlesCount)+" "+x(t.internalArticlesCount===1?"article":"articles"),1),r(p,{type:"light",size:"sm",action:()=>l.showAddSourceModal("internal_article")},{default:f(()=>e[9]||(e[9]=[v("Add article")])),_:1},8,["action"])])]),o("div",Xe,[r(m,{type:"checkbox",modelValue:t.internalArticlesEnabled,"onUpdate:modelValue":e[1]||(e[1]=_=>t.internalArticlesEnabled=_),onChange:l.toggleInternalArticles},null,8,["modelValue","onChange"]),e[10]||(e[10]=o("span",{class:"text-sm text-gray-600"},"Intercom",-1))])]),o("div",Ye,[o("div",Qe,[o("div",$e,[r(g,{size:"24",class:"text-gray-600"}),e[11]||(e[11]=o("div",null,[o("h3",{class:"text-lg font-medium text-gray-900"},"Websites"),o("p",{class:"text-sm text-gray-500"},"Let AI Agent and Copilot use any public website.")],-1))]),o("div",et,[t.websites.length>0?(d(),a("span",tt,"Last synced "+x(l.formattedRelativeDate(t.lastSyncedAt)),1)):y("",!0),r(p,{type:"light",size:"sm",action:()=>l.showAddSourceModal("website")},{default:f(()=>e[12]||(e[12]=[v("Sync")])),_:1},8,["action"])])]),(d(!0),a(N,null,V(t.websites,_=>(d(),a("div",{key:_.id,class:"flex items-center space-x-2 mt-2"},[r(m,{type:"checkbox",modelValue:_.enabled,"onUpdate:modelValue":B=>_.enabled=B,onChange:B=>l.toggleWebsite(_)},null,8,["modelValue","onUpdate:modelValue","onChange"]),o("span",st,x(_.name),1)]))),128)),t.websites.length===0?(d(),a("div",ot,"Not set up")):y("",!0)]),o("div",nt,[o("div",lt,[o("div",it,[r(k,{size:"24",class:"text-gray-600"}),e[13]||(e[13]=o("div",null,[o("h3",{class:"text-lg font-medium text-gray-900"},"More content sources"),o("p",{class:"text-sm text-gray-500"},"Give AI Agent and Copilot sources that aren't visible to your customers.")],-1))])]),o("div",dt,[o("div",rt,[o("div",at,[r(m,{type:"checkbox",modelValue:t.snippetsEnabled,"onUpdate:modelValue":e[2]||(e[2]=_=>t.snippetsEnabled=_),onChange:l.toggleSnippets},null,8,["modelValue","onChange"]),e[14]||(e[14]=o("span",{class:"text-sm text-gray-600"},"Snippets",-1))]),o("div",ct,[o("span",ut,x(t.snippetsCount)+" "+x(t.snippetsCount===1?"snippet":"snippets"),1),r(p,{type:"light",size:"sm",action:()=>l.showAddSourceModal("snippet")},{default:f(()=>e[15]||(e[15]=[v("Add snippet")])),_:1},8,["action"])])]),o("div",pt,[o("div",mt,[r(m,{type:"checkbox",disabled:""}),e[16]||(e[16]=o("span",{class:"text-sm text-gray-600"},"Documents",-1))]),o("div",ht,[e[18]||(e[18]=o("span",{class:"text-sm text-gray-600"},"No documents",-1)),r(p,{type:"light",size:"sm",disabled:""},{default:f(()=>e[17]||(e[17]=[v("Upload document")])),_:1})])]),o("div",ft,[o("div",gt,[r(m,{type:"checkbox",disabled:""}),e[19]||(e[19]=o("span",{class:"text-sm text-gray-600"},"Custom answers",-1))]),o("div",bt,[e[21]||(e[21]=o("span",{class:"text-sm text-gray-600"},"No answers",-1)),r(p,{type:"light",size:"sm",disabled:""},{default:f(()=>e[20]||(e[20]=[v("Add answer")])),_:1})])])])])])],64)):(d(),a("div",yt,[o("div",xt,[r(c,{size:"48",class:"text-gray-400"}),e[23]||(e[23]=o("h2",{class:"text-2xl font-bold text-gray-800"},"No Sources Yet",-1)),e[24]||(e[24]=o("p",{class:"text-sm text-gray-500"},"Add a source to start managing knowledge content.",-1)),r(p,{type:"primary",size:"md",leftIcon:t.Plus,leftIconSize:"20",action:l.showAddSourceModal},{default:f(()=>e[22]||(e[22]=[o("span",null,"Add Source",-1)])),_:1},8,["leftIcon","action"])])])),r(E,{ref:"addSourceModal",knowledgeBaseId:s.knowledgeBaseId,onCreated:l.fetchSources},null,8,["knowledgeBaseId","onCreated"])])}const wt=A(Ee,[["render",_t]]),kt={components:{Folder:O,GripVertical:ve,draggable:ee},props:{node:{type:Object,required:!0},selectedNode:{type:Object,default:null},expandedNodes:{type:Object,required:!0},draggable:{type:Boolean,default:!1}},emits:["toggle-node","node-selected","on-child-add","updated-child-nodes"],data(){return{localNodes:JSON.parse(JSON.stringify(this.node.subfolders))}},methods:{toggleNode(n){this.$emit("toggle-node",n)},selectNode(n){n.subfolders&&n.subfolders.length>0&&this.$emit("toggle-node",n.id,!0),this.$emit("node-selected",n)},onAdd(n){console.log("onAdd 2"),console.log(this.localNodes),this.node.id,this.localNodes[n.newIndex].id;const e=JSON.parse(JSON.stringify(this.localNodes));console.log("send child nodes 2"),console.log(e)},onChildAdd(n,e,s,i){console.log("onChildAdd 2");let t=JSON.parse(JSON.stringify(this.localNodes));t[n].subfolders=i},onRemove(n){console.log("onRemove 2"),console.log(this.localNodes)}}},vt=["aria-expanded","id"],Nt={class:"hs-accordion-heading py-0.5 flex items-center gap-x-0.5 w-full"},Ct={key:0,class:"size-6 flex justify-center items-center cursor-move"},St={key:1,class:"size-6 flex justify-center items-center"},At=["aria-expanded","aria-controls"],It={key:3,class:"size-6 flex justify-center items-center"},Mt={class:"flex items-center gap-x-2"},Tt={class:"w-20 grow truncate -mt-0.5"},Vt={class:"text-xs text-gray-800 dark:text-neutral-200"},zt=["id","aria-labelledby"],Et={class:"hs-accordion-group ps-4 relative before:absolute before:top-0 before:start-3 before:w-0.5 before:-ms-px before:h-full before:bg-gray-100 dark:before:bg-neutral-700",role:"group","data-hs-accordion-always-open":""};function Bt(n,e,s,i,t,l){const c=u("GripVertical"),p=u("Folder"),m=u("TreeNode",!0),h=u("draggable");return d(),a("div",{class:C(["rounded-lg",s.selectedNode&&s.selectedNode.id===s.node.id?"bg-gray-100 dark:bg-neutral-700":"","hs-accordion",s.expandedNodes[s.node.id]?"active":""]),role:"treeitem","aria-expanded":s.expandedNodes[s.node.id]?"true":"false",id:"hs-customize-tree-heading-"+s.node.id},[o("div",Nt,[s.draggable?(d(),a("div",Ct,[r(c,{class:"size-4 text-gray-500 dark:text-neutral-500"})])):(d(),a("div",St)),s.node.subfolders&&s.node.subfolders.length>0?(d(),a("button",{key:2,class:"hs-accordion-toggle size-6 flex justify-center items-center hover:bg-gray-100 rounded-md focus:outline-none focus:bg-gray-100 disabled:opacity-50 disabled:pointer-events-none dark:hover:bg-neutral-700 dark:focus:bg-neutral-700","aria-expanded":s.expandedNodes[s.node.id]?"true":"false","aria-controls":"hs-customize-tree-collapse-"+s.node.id,onClick:e[0]||(e[0]=g=>l.toggleNode(s.node.id))},[(d(),a("svg",{class:C([s.expandedNodes[s.node.id]?"rotate-90":"","transition duration-300 size-2.5 text-gray-600 dark:text-neutral-400"]),xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16"},e[2]||(e[2]=[o("path",{d:"m12.14 8.753-5.482 4.796c-.646.566-1.658.106-1.658-.753V3.204a1 1 0 0 1 1.659-.753l5.48 4.796a1 1 0 0 1 0 1.506z"},null,-1)]),2))],8,At)):(d(),a("div",It)),o("div",{class:"grow hs-accordion-selectable px-1.5 rounded-md cursor-pointer",onClick:e[1]||(e[1]=g=>l.selectNode(s.node))},[o("div",Mt,[r(p,{class:C(s.node.hasContent?"shrink-0 size-4 text-blue-500 dark:text-blue-500":"shrink-0 size-4 text-yellow-500 dark:text-neutral-500")},null,8,["class"]),o("div",Tt,[o("span",Vt,x(s.node.title),1)])])])]),s.node.subfolders&&s.node.subfolders.length>0?(d(),a("div",{key:0,id:"hs-customize-tree-collapse-"+s.node.id,class:C(["hs-accordion-content w-full overflow-hidden transition-[height] duration-300",s.expandedNodes[s.node.id]?"":"hidden"]),role:"group","aria-labelledby":"hs-customize-tree-heading-"+s.node.id},[o("div",Et,[r(h,{disabled:!s.draggable,list:s.node.subfolders,onRemove:l.onRemove,animation:"200",group:"folders",onAdd:l.onAdd},{default:f(()=>[(d(!0),a(N,null,V(t.localNodes,(g,k)=>(d(),w(m,{onOnChildAdd:(E,_,B)=>l.onChildAdd(k,E,_,B),expandedNodes:s.expandedNodes,selectedNode:s.selectedNode,onNodeSelected:l.selectNode,node:t.localNodes[k],onToggleNode:l.toggleNode,draggable:s.draggable,key:g.id},null,8,["onOnChildAdd","expandedNodes","selectedNode","onNodeSelected","node","onToggleNode","draggable"]))),128))]),_:1},8,["disabled","list","onRemove","onAdd"])])],10,zt)):y("",!0)],10,vt)}const Ft=A(kt,[["render",Bt]]),Pt={components:{Folder:O,TreeNode:Ft,draggable:ee},props:{nodes:{type:Array,default:()=>[]},selectedNode:{type:Object,default:null},draggable:{type:Boolean,default:!1}},emits:["update-expansion-state","node-selected","on-child-add"],data(){return{key:0,localNodes:JSON.parse(JSON.stringify(this.nodes)),expandedNodes:{all:!0}}},watch:{expandedNodes:{handler(){this.areAllNodesExpanded?this.$emit("update-expansion-state",!0):this.areAllNodesCollapsed&&this.$emit("update-expansion-state",!1)},deep:!0}},computed:{areAllNodesExpanded(){return this.expandedNodes.all?this.checkNodesExpanded(this.localNodes):!1},areAllNodesCollapsed(){return this.expandedNodes.all?!1:this.checkNodesCollapsed(this.localNodes)},hasContentInTree(){const n=e=>Array.isArray(e)?e.some(s=>s.hasContent?!0:n(s.subfolders||[])):!1;return n(this.localNodes)}},methods:{toggleNode(n,e=null){e!==null?this.expandedNodes[n]=e:this.expandedNodes[n]=!this.expandedNodes[n]},selectNode(n){this.expandedNodes[n.id]=!0,this.$emit("node-selected",n)},expandAll(){this.expandedNodes.all=!0,this.expandNodes(this.localNodes)},collapseAll(){this.expandedNodes.all=!1,this.collapseNodes(this.localNodes)},expandNodes(n){n.forEach(e=>{this.expandedNodes[e.id]=!0,e.subfolders&&e.subfolders.length>0&&this.expandNodes(e.subfolders)})},collapseNodes(n){n.forEach(e=>{this.expandedNodes[e.id]=!1,e.subfolders&&e.subfolders.length>0&&this.collapseNodes(e.subfolders)})},checkNodesExpanded(n){return n.every(e=>{const s=this.expandedNodes[e.id]||!1;return e.subfolders&&e.subfolders.length>0?s&&this.checkNodesExpanded(e.subfolders):!0})},checkNodesCollapsed(n){return n.every(e=>{const s=!this.expandedNodes[e.id];return e.subfolders&&e.subfolders.length>0?s&&this.checkNodesCollapsed(e.subfolders):!0})},onAdd(n){console.log("onAdd 1"),console.log(this.localNodes),this.localNodes[n.newIndex].id;const e=JSON.parse(JSON.stringify(this.localNodes));console.log("send child nodes 1"),console.log(e)},onChildAdd(n,e,s,i){console.log("onChildAdd 1");let t=JSON.parse(JSON.stringify(this.localNodes));t[n].subfolders=i},onRemove(){console.log("onRemove 1"),console.log(this.localNodes)}},mounted(){this.$emit("update-expansion-state",this.areAllNodesExpanded)}},Ut={class:"hs-accordion-treeview-root",role:"tree","aria-orientation":"vertical"},jt={class:"hs-accordion-group",role:"group","data-hs-accordion-always-open":""},Lt=["aria-expanded"],Dt={class:"hs-accordion-heading py-0.5 flex items-center gap-x-0.5 w-full"},Ot=["aria-expanded"],Rt={class:"flex items-center gap-x-2"},Ht={class:"hs-accordion-group ps-4 relative before:absolute before:top-0 before:start-3 before:w-0.5 before:-ms-px before:h-full before:bg-gray-100 dark:before:bg-neutral-700",role:"group","data-hs-accordion-always-open":""};function qt(n,e,s,i,t,l){const c=u("Folder"),p=u("TreeNode"),m=u("draggable");return d(),a("div",Ut,[o("div",jt,[o("div",{class:C(["rounded-lg",s.selectedNode&&s.selectedNode.id==="all"?"bg-gray-100 dark:bg-neutral-700":"","hs-accordion",t.expandedNodes.all?"active":""]),role:"treeitem","aria-expanded":t.expandedNodes.all?"true":"false",id:"hs-customize-tree-heading-all"},[o("div",Dt,[o("button",{class:"hs-accordion-toggle size-6 flex justify-center items-center hover:bg-gray-100 rounded-md focus:outline-none focus:bg-gray-100 disabled:opacity-50 disabled:pointer-events-none dark:hover:bg-neutral-700 dark:focus:bg-neutral-700","aria-expanded":t.expandedNodes.all?"true":"false","aria-controls":"hs-customize-tree-collapse-all",onClick:e[0]||(e[0]=h=>l.toggleNode("all"))},[(d(),a("svg",{class:C([t.expandedNodes.all?"rotate-90":"","transition duration-300 size-2.5 text-gray-600 dark:text-neutral-400"]),xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16"},e[2]||(e[2]=[o("path",{d:"m12.14 8.753-5.482 4.796c-.646.566-1.658.106-1.658-.753V3.204a1 1 0 0 1 1.659-.753l5.48 4.796a1 1 0 0 1 0 1.506z"},null,-1)]),2))],8,Ot),o("div",{class:"grow hs-accordion-selectable px-1.5 rounded-md cursor-pointer",onClick:e[1]||(e[1]=h=>l.selectNode({id:"all",title:"All"}))},[o("div",Rt,[r(c,{class:C(l.hasContentInTree?"shrink-0 size-4 text-blue-500 dark:text-blue-500":"shrink-0 size-4 text-gray-500 dark:text-neutral-500")},null,8,["class"]),e[3]||(e[3]=o("div",{class:"grow -mt-0.5"},[o("span",{class:"text-xs text-gray-800 dark:text-neutral-200"},"All")],-1))])])]),o("div",{id:"hs-customize-tree-collapse-all",class:C(["hs-accordion-content w-full overflow-hidden transition-[height] duration-300",t.expandedNodes.all?"":"hidden"]),role:"group","aria-labelledby":"hs-customize-tree-heading-all"},[o("div",Ht,[(d(),w(m,{disabled:!s.draggable,list:s.nodes,onRemove:l.onRemove,animation:"200",group:"folders",onAdd:l.onAdd,key:t.key},{default:f(()=>[(d(!0),a(N,null,V(t.localNodes,(h,g)=>(d(),w(p,{onOnChildAdd:(k,E,_)=>l.onChildAdd(g,k,E,_),expandedNodes:t.expandedNodes,selectedNode:s.selectedNode,onNodeSelected:l.selectNode,onToggleNode:l.toggleNode,node:t.localNodes[g],draggable:s.draggable,key:h.id},null,8,["onOnChildAdd","expandedNodes","selectedNode","onNodeSelected","onToggleNode","node","draggable"]))),128))]),_:1},8,["disabled","list","onRemove","onAdd"]))])],2)],10,Lt)])])}const Wt=A(Pt,[["render",qt]]),Jt={props:{path:{type:Array,required:!0,default:()=>[]},action:{type:Function,default:null}},methods:{handleClick(n){this.action&&this.action(n)}}},Gt={class:"flex items-center whitespace-nowrap text-sm"},Kt=["onClick"],Zt={class:"inline-flex items-center font-semibold text-gray-800 truncate dark:text-neutral-200","aria-current":"page"};function Xt(n,e,s,i,t,l){return d(),a("ol",Gt,[(d(!0),a(N,null,V(s.path.slice(0,-1),(c,p)=>(d(),a("li",{key:p,class:"inline-flex items-center"},[o("button",{onClick:m=>l.handleClick(c.id),class:C([{"hover:text-blue-600 active:text-blue-500 cursor-pointer":s.action},"flex items-center text-gray-500"])},x(c.title),11,Kt),e[0]||(e[0]=o("svg",{class:"shrink-0 mx-2 size-4 text-gray-400 dark:text-neutral-600",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[o("path",{d:"m9 18 6-6-6-6"})],-1))]))),128)),o("li",Zt,x(s.path[s.path.length-1].title),1)])}const R=A(Jt,[["render",Xt]]),Yt={inject:["formState","notificationState"],components:{Modal:P,Input:U,Select:Q,Button:z,Breadcrumbs:R},props:{knowledgeBaseId:{type:String,required:!0},parentId:{type:String,default:null},treeNodes:{type:Array,default:()=>[]},selectedNode:{type:Object,default:()=>({id:"all",title:"All"})}},data(){return{isSubmitting:!1,form:{title:"",type:"folder",parent_id:this.parentId,knowledge_base_id:this.knowledgeBaseId}}},computed:{breadcrumbPath(){if(!this.selectedNode||this.selectedNode.id==="all")return[{id:"all",title:"All"}];const n=[{id:"all",title:"All"}],e=(i,t,l=[])=>{for(const c of i){const p=[...l,{id:c.id,title:c.title}];if(c.id===t)return p;if(c.subfolders&&c.subfolders.length>0){const m=e(c.subfolders,t,p);if(m)return m}}return null},s=e(this.treeNodes,this.selectedNode.id);return s?[...n,...s]:n}},watch:{parentId(n){this.form.parent_id=n}},methods:{showModal(){this.reset(),this.$refs.modal.showModal()},reset(){this.form.title="",this.formState.hideFormErrors()},async submit(n){var e,s;if(this.formState.hideFormErrors(),!this.form.title.trim()){this.formState.setFormError("title","Folder name is required");return}this.isSubmitting=!0;try{const i={type:this.form.type,title:this.form.title,parent_id:this.form.parent_id,knowledge_base_id:this.form.knowledge_base_id};await S.post("/api/content-items",i),this.notificationState.showSuccessNotification("Folder added successfully."),this.$emit("created"),n()}catch(i){const t=((s=(e=i==null?void 0:i.response)==null?void 0:e.data)==null?void 0:s.message)||(i==null?void 0:i.message)||"Failed to add folder";this.notificationState.showWarningNotification(t),this.formState.setServerFormErrors(i),console.error("Failed to add folder:",i)}finally{this.isSubmitting=!1}}}},Qt={class:"space-y-4"};function $t(n,e,s,i,t,l){const c=u("Breadcrumbs"),p=u("Input"),m=u("Modal");return d(),w(m,{size:"md",ref:"modal",showFooter:!0,dismissable:!0,scrollOnContent:!1,showApproveButton:!0,header:"Add Folder",approveText:"Add",approveLoading:t.isSubmitting,approveAction:l.submit,subheader:"Add a new folder to the knowledge base"},{content:f(()=>[o("div",Qt,[r(c,{path:l.breadcrumbPath},null,8,["path"]),r(p,{modelValue:t.form.title,"onUpdate:modelValue":e[0]||(e[0]=h=>t.form.title=h),showAsterisk:!0,label:"Folder Name",placeholder:"Folder Name",errorText:l.formState.getFormError("title")},null,8,["modelValue","errorText"])])]),_:1},8,["approveLoading","approveAction"])}const es=A(Yt,[["render",$t]]),ts={inject:["formState","notificationState"],components:{Modal:P,Input:U,Select:Q,Button:z,Breadcrumbs:R},props:{knowledgeBaseId:{type:String,required:!0},folderId:{type:String,default:null},treeNodes:{type:Array,default:()=>[]},selectedNode:{type:Object,default:()=>({id:"all",title:"All"})}},data(){return{isSubmitting:!1,helpCenterCollections:[],contentTypes:[{label:"Article",value:"article"},{label:"Snippet",value:"snippet"}],visibilityOptions:[{label:"Public",value:"public"},{label:"Internal",value:"internal"}],stateOptions:[{label:"Draft",value:"draft"},{label:"Active",value:"active"},{label:"Archived",value:"archived"}],form:{type:"article",title:"",content:"",state:"active",visibility:"internal",ai_agent_enabled:!0,copilot_enabled:!0,help_center_enabled:!1,help_center_collection_id:"",parent_id:this.folderId,knowledge_base_id:this.knowledgeBaseId}}},computed:{helpCenterCollectionOptions(){return[{label:"No Collection",value:""},...this.helpCenterCollections.map(n=>({label:n.name,value:n.id}))]},breadcrumbPath(){if(!this.selectedNode||this.selectedNode.id==="all")return[{id:"all",title:"All"}];const n=[{id:"all",title:"All"}],e=(i,t,l=[])=>{for(const c of i){const p=[...l,{id:c.id,title:c.title}];if(c.id===t)return p;if(c.subfolders&&c.subfolders.length>0){const m=e(c.subfolders,t,p);if(m)return m}}return null},s=e(this.treeNodes,this.selectedNode.id);return s?[...n,...s]:n}},watch:{folderId(n){this.form.parent_id=n},"form.type"(n){n!=="article"&&(this.form.visibility=null,this.form.help_center_enabled=!1,this.form.help_center_collection_id="")},"form.visibility"(n){n==="internal"&&(this.form.help_center_enabled=!1,this.form.help_center_collection_id="")}},methods:{showModal(){this.reset(),this.$refs.modal.showModal(),this.fetchHelpCenterCollections()},reset(){this.form.type="article",this.form.title="",this.form.content="",this.form.visibility="internal",this.form.state="active",this.form.ai_agent_enabled=!0,this.form.copilot_enabled=!0,this.form.help_center_enabled=!1,this.form.help_center_collection_id="",this.formState.hideFormErrors()},async fetchHelpCenterCollections(){var n,e;try{const s=await S.get("/api/help-center-collections",{params:{knowledge_base_id:this.knowledgeBaseId}});this.helpCenterCollections=s.data.data||[]}catch(s){const i=((e=(n=s==null?void 0:s.response)==null?void 0:n.data)==null?void 0:e.message)||(s==null?void 0:s.message)||"Failed to fetch Help Center collections";this.notificationState.showWarningNotification(i),console.error("Failed to fetch Help Center collections:",s)}},async submit(n){var e,s;if(this.formState.hideFormErrors(),this.form.title.trim()||this.formState.setFormError("title","Title is required"),this.form.type==="article"&&!this.form.visibility&&this.formState.setFormError("visibility","Visibility is required for articles"),this.form.type==="article"&&!this.form.state&&this.formState.setFormError("state","State is required"),this.form.type==="article"&&this.form.visibility==="public"&&this.form.help_center_enabled&&!this.form.help_center_collection_id&&this.formState.setFormError("help_center_collection_id","Help Center Collection is required for public articles added to Help Center"),!this.formState.hasErrors){this.isSubmitting=!0;try{const i={type:this.form.type,title:this.form.title,content:this.form.content||"",state:this.form.type==="article"?this.form.state:null,ai_agent_enabled:this.form.ai_agent_enabled,copilot_enabled:this.form.copilot_enabled,help_center_enabled:this.form.help_center_enabled,help_center_collection_id:this.form.help_center_collection_id||null,parent_id:this.form.parent_id,knowledge_base_id:this.form.knowledge_base_id};this.form.type==="article"&&(i.visibility=this.form.visibility),await S.post("/api/content-items",i),this.notificationState.showSuccessNotification("Content added successfully."),this.$emit("created"),n()}catch(i){const t=((s=(e=i==null?void 0:i.response)==null?void 0:e.data)==null?void 0:s.message)||(i==null?void 0:i.message)||"Failed to add content";this.notificationState.showWarningNotification(t),this.formState.setServerFormErrors(i),console.error("Failed to add content:",i)}finally{this.isSubmitting=!1}}}}},ss={class:"space-y-4"},os={class:"flex space-x-4"};function ns(n,e,s,i,t,l){const c=u("Breadcrumbs"),p=u("Select"),m=u("Input"),h=u("Modal");return d(),w(h,{size:"md",ref:"modal",showFooter:!0,dismissable:!0,scrollOnContent:!1,showApproveButton:!0,header:"Add Content",approveText:"Add",approveLoading:t.isSubmitting,approveAction:l.submit,subheader:"Add a new content item to the knowledge base"},{content:f(()=>[o("div",ss,[r(c,{path:l.breadcrumbPath},null,8,["path"]),r(p,{label:"Type",search:!1,modelValue:t.form.type,"onUpdate:modelValue":e[0]||(e[0]=g=>t.form.type=g),showAsterisk:!0,options:t.contentTypes,placeholder:"Select content type",errorText:l.formState.getFormError("type")},null,8,["modelValue","options","errorText"]),r(m,{label:"Title",modelValue:t.form.title,"onUpdate:modelValue":e[1]||(e[1]=g=>t.form.title=g),showAsterisk:!0,placeholder:"Content Title",errorText:l.formState.getFormError("title")},null,8,["modelValue","errorText"]),r(m,{rows:"4",type:"textarea",label:"Content",placeholder:"Content",modelValue:t.form.content,"onUpdate:modelValue":e[2]||(e[2]=g=>t.form.content=g),errorText:l.formState.getFormError("content")},null,8,["modelValue","errorText"]),t.form.type==="article"?(d(),w(p,{key:0,label:"State",search:!1,modelValue:t.form.state,"onUpdate:modelValue":e[3]||(e[3]=g=>t.form.state=g),showAsterisk:!0,options:t.stateOptions,placeholder:"Select state",errorText:l.formState.getFormError("state")},null,8,["modelValue","options","errorText"])):y("",!0),t.form.type==="article"?(d(),w(p,{key:1,search:!1,label:"Visibility",showAsterisk:!0,modelValue:t.form.visibility,"onUpdate:modelValue":e[4]||(e[4]=g=>t.form.visibility=g),options:t.visibilityOptions,placeholder:"Select visibility",errorText:l.formState.getFormError("visibility")},null,8,["modelValue","options","errorText"])):y("",!0),t.form.type==="article"&&t.form.visibility==="public"?(d(),w(p,{key:2,label:"Help Center Collection",placeholder:"Select collection",options:l.helpCenterCollectionOptions,modelValue:t.form.help_center_collection_id,"onUpdate:modelValue":e[5]||(e[5]=g=>t.form.help_center_collection_id=g),errorText:l.formState.getFormError("help_center_collection_id")},null,8,["options","modelValue","errorText"])):y("",!0),o("div",os,[r(m,{type:"checkbox",inputLabel:"Copilot",modelValue:t.form.copilot_enabled,"onUpdate:modelValue":e[6]||(e[6]=g=>t.form.copilot_enabled=g)},null,8,["modelValue"]),r(m,{type:"checkbox",inputLabel:"AI Agent",modelValue:t.form.ai_agent_enabled,"onUpdate:modelValue":e[7]||(e[7]=g=>t.form.ai_agent_enabled=g)},null,8,["modelValue"]),t.form.type==="article"?(d(),w(m,{key:0,type:"checkbox",inputLabel:"Help Center",modelValue:t.form.help_center_enabled,"onUpdate:modelValue":e[8]||(e[8]=g=>t.form.help_center_enabled=g)},null,8,["modelValue"])):y("",!0)])])]),_:1},8,["approveLoading","approveAction"])}const ls=A(ts,[["render",ns]]),is={inject:["formState","notificationState"],components:{Modal:P,Input:U,Button:z},data(){return{contentItem:null,helpCenterCollections:[],form:{type:"",title:"",content:"",url:"",visibility:"internal",ai_agent_enabled:!0,copilot_enabled:!0,help_center_enabled:!1,help_center_collection_id:""}}},methods:{showModal(n){this.contentItem=n,this.form.type=n.type,this.form.title=n.title,this.form.content=n.content||"",this.form.url=n.url||"",this.form.visibility=n.visibility,this.form.ai_agent_enabled=n.ai_agent_enabled,this.form.copilot_enabled=n.copilot_enabled,this.form.help_center_enabled=n.help_center_enabled,this.form.help_center_collection_id=n.help_center_collection_id||"",this.$refs.modal.showModal(),this.fetchHelpCenterCollections()},closeModal(){this.$refs.modal.closeModal(),this.form.type="",this.form.title="",this.form.content="",this.form.url="",this.form.visibility="internal",this.form.ai_agent_enabled=!0,this.form.copilot_enabled=!0,this.form.help_center_enabled=!1,this.form.help_center_collection_id=""},async fetchHelpCenterCollections(){var n,e;try{const s=await S.get("/api/help-center-collections",{params:{knowledge_base_id:this.contentItem.knowledge_base_id}});this.helpCenterCollections=s.data.data||[]}catch(s){const i=((e=(n=s==null?void 0:s.response)==null?void 0:n.data)==null?void 0:e.message)||(s==null?void 0:s.message)||"Failed to fetch Help Center collections";this.notificationState.showWarningNotification(i),console.error("Failed to fetch Help Center collections:",s)}},async submit(){var n,e;try{this.formState.isLoading=!0,await S.put(`/api/knowledge-bases/${this.contentItem.knowledge_base_id}/content-items/${this.contentItem.id}`,this.form),this.notificationState.showSuccessNotification("Content updated successfully."),this.$emit("updated"),this.closeModal()}catch(s){const i=((e=(n=s==null?void 0:s.response)==null?void 0:n.data)==null?void 0:e.message)||(s==null?void 0:s.message)||"Failed to update content";this.notificationState.showWarningNotification(i),console.error("Failed to update content:",s)}finally{this.formState.isLoading=!1}}}},ds={key:0},rs={key:1},as={key:2},cs={key:3},us=["value"],ps={key:4,class:"flex space-x-4"},ms={class:"flex items-center space-x-2"},hs={class:"flex items-center space-x-2"},fs={class:"flex items-center space-x-2"},gs={class:"flex justify-end space-x-2"};function bs(n,e,s,i,t,l){const c=u("Input"),p=u("Button"),m=u("Modal");return d(),w(m,{ref:"modal",title:"Update Content",size:"md"},{default:f(()=>[o("form",{onSubmit:e[9]||(e[9]=Y((...h)=>l.submit&&l.submit(...h),["prevent"])),class:"space-y-4"},[o("div",null,[e[11]||(e[11]=o("label",{for:"type",class:"block text-sm font-medium text-gray-700"},"Type",-1)),T(o("select",{id:"type","onUpdate:modelValue":e[0]||(e[0]=h=>t.form.type=h),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",disabled:""},e[10]||(e[10]=[o("option",{value:"folder"},"Folder",-1),o("option",{value:"article"},"Article",-1),o("option",{value:"snippet"},"Snippet",-1),o("option",{value:"webpage"},"Webpage",-1)]),512),[[j,t.form.type]])]),o("div",null,[e[12]||(e[12]=o("label",{for:"title",class:"block text-sm font-medium text-gray-700"},"Title",-1)),T(o("input",{id:"title",type:"text","onUpdate:modelValue":e[1]||(e[1]=h=>t.form.title=h),placeholder:"Content Title",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[F,t.form.title]])]),t.form.type!=="webpage"&&t.form.type!=="folder"?(d(),a("div",ds,[e[13]||(e[13]=o("label",{for:"content",class:"block text-sm font-medium text-gray-700"},"Content",-1)),T(o("textarea",{id:"content","onUpdate:modelValue":e[2]||(e[2]=h=>t.form.content=h),rows:"4",placeholder:"Content",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[F,t.form.content]])])):y("",!0),t.form.type==="webpage"?(d(),a("div",rs,[e[14]||(e[14]=o("label",{for:"url",class:"block text-sm font-medium text-gray-700"},"URL",-1)),T(o("input",{id:"url",type:"text","onUpdate:modelValue":e[3]||(e[3]=h=>t.form.url=h),placeholder:"https://example.com",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[F,t.form.url]])])):y("",!0),t.form.type!=="folder"?(d(),a("div",as,[e[16]||(e[16]=o("label",{for:"visibility",class:"block text-sm font-medium text-gray-700"},"Visibility",-1)),T(o("select",{id:"visibility","onUpdate:modelValue":e[4]||(e[4]=h=>t.form.visibility=h),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},e[15]||(e[15]=[o("option",{value:"public"},"Public",-1),o("option",{value:"internal"},"Internal",-1)]),512),[[j,t.form.visibility]])])):y("",!0),t.form.type!=="folder"?(d(),a("div",cs,[e[18]||(e[18]=o("label",{for:"help_center_collection_id",class:"block text-sm font-medium text-gray-700"},"Help Center Collection",-1)),T(o("select",{id:"help_center_collection_id","onUpdate:modelValue":e[5]||(e[5]=h=>t.form.help_center_collection_id=h),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},[e[17]||(e[17]=o("option",{value:""},"No Collection",-1)),(d(!0),a(N,null,V(t.helpCenterCollections,h=>(d(),a("option",{key:h.id,value:h.id},x(h.name),9,us))),128))],512),[[j,t.form.help_center_collection_id]])])):y("",!0),t.form.type!=="folder"?(d(),a("div",ps,[o("div",ms,[r(c,{type:"checkbox",modelValue:t.form.ai_agent_enabled,"onUpdate:modelValue":e[6]||(e[6]=h=>t.form.ai_agent_enabled=h)},null,8,["modelValue"]),e[19]||(e[19]=o("label",{class:"text-sm text-gray-700"},"AI Agent",-1))]),o("div",hs,[r(c,{type:"checkbox",modelValue:t.form.copilot_enabled,"onUpdate:modelValue":e[7]||(e[7]=h=>t.form.copilot_enabled=h)},null,8,["modelValue"]),e[20]||(e[20]=o("label",{class:"text-sm text-gray-700"},"Copilot",-1))]),o("div",fs,[r(c,{type:"checkbox",modelValue:t.form.help_center_enabled,"onUpdate:modelValue":e[8]||(e[8]=h=>t.form.help_center_enabled=h)},null,8,["modelValue"]),e[21]||(e[21]=o("label",{class:"text-sm text-gray-700"},"Help Center",-1))])])):y("",!0),o("div",gs,[r(p,{type:"light",size:"sm",action:l.closeModal},{default:f(()=>e[22]||(e[22]=[v("Cancel")])),_:1},8,["action"]),r(p,{type:"primary",size:"sm",loading:l.formState.isLoading},{default:f(()=>e[23]||(e[23]=[v("Update")])),_:1},8,["loading"])])],32)]),_:1},512)}const ys=A(is,[["render",bs]]),xs={inject:["formState","notificationState"],components:{Modal:P,Button:z},data(){return{contentItem:null}},methods:{showModal(n){this.contentItem=n,this.$refs.modal.showModal()},closeModal(){this.$refs.modal.closeModal(),this.contentItem=null},async submit(){var n,e;try{this.formState.isLoading=!0,await S.delete(`/api/knowledge-bases/${this.contentItem.knowledge_base_id}/content-items/${this.contentItem.id}`),this.notificationState.showSuccessNotification("Content deleted successfully."),this.$emit("deleted",this.contentItem.id),this.closeModal()}catch(s){const i=((e=(n=s==null?void 0:s.response)==null?void 0:n.data)==null?void 0:e.message)||(s==null?void 0:s.message)||"Failed to delete content";this.notificationState.showWarningNotification(i),console.error("Failed to delete content:",s)}finally{this.formState.isLoading=!1}}}},_s={class:"space-y-4"},ws={class:"text-sm text-gray-600"},ks={class:"flex justify-end space-x-2"};function vs(n,e,s,i,t,l){const c=u("Button"),p=u("Modal");return d(),w(p,{ref:"modal",title:"Delete Content",size:"md"},{default:f(()=>{var m;return[o("div",_s,[o("p",ws,' Are you sure you want to delete "'+x((m=t.contentItem)==null?void 0:m.title)+'"? ',1),o("div",ks,[r(c,{type:"light",size:"sm",action:l.closeModal},{default:f(()=>e[0]||(e[0]=[v("Cancel")])),_:1},8,["action"]),r(c,{type:"danger",size:"sm",loading:l.formState.isLoading,action:l.submit},{default:f(()=>e[1]||(e[1]=[v("Delete")])),_:1},8,["loading","action"])])])]}),_:1},512)}const Ns=A(xs,[["render",vs]]),Cs={inject:["formState","notificationState"],components:{Modal:P,Button:z},data(){return{contentItemIds:[]}},methods:{showModal(n){this.contentItemIds=n,this.$refs.modal.showModal()},closeModal(){this.$refs.modal.closeModal(),this.contentItemIds=[]},async submit(){var n,e;try{this.formState.isLoading=!0,await S.delete("/api/knowledge-bases",{params:{content_item_ids:this.contentItemIds}}),this.notificationState.showSuccessNotification("Content items deleted successfully."),this.$emit("deleted",this.contentItemIds),this.closeModal()}catch(s){const i=((e=(n=s==null?void 0:s.response)==null?void 0:n.data)==null?void 0:e.message)||(s==null?void 0:s.message)||"Failed to delete content items";this.notificationState.showWarningNotification(i),console.error("Failed to delete content items:",s)}finally{this.formState.isLoading=!1}}}},Ss={class:"space-y-4"},As={class:"text-sm text-gray-600"},Is={class:"flex justify-end space-x-2"};function Ms(n,e,s,i,t,l){const c=u("Button"),p=u("Modal");return d(),w(p,{ref:"modal",title:"Delete Content Items",size:"md"},{default:f(()=>[o("div",Ss,[o("p",As," Are you sure you want to delete "+x(t.contentItemIds.length)+" content "+x(t.contentItemIds.length===1?"item":"items")+"? ",1),o("div",Is,[r(c,{type:"light",size:"sm",action:l.closeModal},{default:f(()=>e[0]||(e[0]=[v("Cancel")])),_:1},8,["action"]),r(c,{type:"danger",size:"sm",loading:l.formState.isLoading,action:l.submit},{default:f(()=>e[1]||(e[1]=[v("Delete")])),_:1},8,["loading","action"])])])]),_:1},512)}const Ts=A(Cs,[["render",Ms]]),Vs={inject:["formState","notificationState"],components:{Input:U,Button:z,Dropdown:pe,Table:ce,Pill:ae,Tree:Wt,Breadcrumbs:R,AddFolderModal:es,AddContentModal:ls,UpdateContentModal:ys,DeleteContentModal:Ns,DeleteContentsModal:Ts,Folder:O,FileText:fe,StickyNote:Se,Earth:xe,Lock:D,Unlock:X,Check:he,X:me},props:{knowledgeBaseId:{type:String,required:!0}},data(){return{Plus:$,Pencil:ge,Trash2:K,FolderPlus:we,SquarePlus:Ce,SquareMinus:Ne,Lock:D,Unlock:X,contentItems:[],treeNodes:[],selectedNode:{id:"all",title:"All"},perPage:"15",checkedRows:[],pagination:null,searchTerm:null,selectAll:!1,filterExpressions:[],sortingExpressions:[],isLoadingContentItems:!1,isTreeExpanded:!0,isDraggable:!0,columns:this.prepareColumns(),dropdownOptions:[{icon:K,label:"Delete",action:this.showDeleteContentsModal}]}},computed:{hasSearchTerm(){return this.searchTerm!=null&&this.searchTerm.trim()!=""},totalCheckedRows(){return Object.values(this.checkedRows).filter(n=>n).length},hasFilterExpressions(){return this.filterExpressions.length>0},hasSortingExpressions(){return this.sortingExpressions.length>0},breadcrumbPath(){if(!this.selectedNode||this.selectedNode.id==="all")return[{id:"all",title:"All"}];const n=[{id:"all",title:"All"}],e=(i,t,l=[])=>{for(const c of i){const p=[...l,{id:c.id,title:c.title}];if(c.id===t)return p;if(c.subfolders&&c.subfolders.length>0){const m=e(c.subfolders,t,p);if(m)return m}}return null},s=e(this.treeNodes,this.selectedNode.id);return s?[...n,...s]:n}},watch:{selectedNode(){this.fetchContentItems()},selectAll(n){this.checkedRows=this.contentItems.reduce((e,s)=>(e[s.id]=n,e),{})}},methods:{prepareColumns(){const n=["Title","Type","Copilot","AI Agent","Help Center","Help Center collection"],e=["Title","Type","Copilot","AI Agent","Help Center","Help Center collection"];return n.map(s=>({name:s,active:e.includes(s),priority:e.includes(s)}))},showAddFolderModal(){this.$refs.addFolderModal.showModal()},showAddContentModal(){this.$refs.addContentModal.showModal()},showUpdateContentModal(n){this.$refs.updateContentModal.showModal(n)},showDeleteContentModal(n){this.$refs.deleteContentModal.showModal(n)},showDeleteContentsModal(){const n=this.contentItems.filter(e=>this.checkedRows[e.id]).map(e=>e.id);this.$refs.deleteContentsModal.showModal(n)},onNodeSelected(n){if(typeof n=="string"){const e=(i,t)=>{for(const l of i){if(l.id===t)return l;if(l.subfolders&&l.subfolders.length>0){const c=e(l.subfolders,t);if(c)return c}}return null},s=e(this.treeNodes,n);this.selectedNode=s||{id:"all",title:"All"}}else this.selectedNode=n},onBreadcrumbClick(n){if(n==="all")this.selectedNode={id:"all",title:"All"};else{const e=this.breadcrumbPath.find(s=>s.id===n);e?this.selectedNode={id:e.id,title:e.title}:this.selectedNode={id:"all",title:"All"}}this.$refs.tree&&typeof this.$refs.tree.selectNode=="function"&&this.$refs.tree.selectNode(this.selectedNode)},onContentDeleted(n){this.contentItems=this.contentItems.filter(e=>e.id!==n),this.fetchTreeNodes(),this.contentItems.length===0&&this.fetchContentItems()},onContentsDeleted(n=[]){n.forEach(e=>{this.checkedRows[e]!==void 0&&(this.checkedRows[e]=!1)}),this.selectAll=!1,this.contentItems=this.contentItems.filter(e=>!n.includes(e.id)),this.fetchTreeNodes(),this.contentItems.length===0&&this.fetchContentItems()},paginate(n){this.fetchContentItems(n)},search(n){this.searchTerm=n,this.fetchContentItems()},updatedColumns(n){this.columns=n},updatedFilters(n){const e=n.map(s=>s.expression);G(this.filterExpressions,e)||(this.filterExpressions=e,this.fetchContentItems())},updatedSorting(n){const e=n.map(s=>s.expression);G(this.sortingExpressions,e)||(this.sortingExpressions=e,this.fetchContentItems())},updatedPerPage(n){this.perPage=n,this.fetchContentItems()},async fetchTreeNodes(){var n,e;try{const s=await S.get("/api/content-items",{params:{knowledge_base_id:this.knowledgeBaseId,type:"folder"}});this.treeNodes=s.data}catch(s){const i=((e=(n=s==null?void 0:s.response)==null?void 0:n.data)==null?void 0:e.message)||(s==null?void 0:s.message)||"Something went wrong while fetching content tree";this.notificationState.showWarningNotification(i),console.error("Failed to fetch content tree:",s)}},async fetchContentItems(n=null){var e,s;try{this.isLoadingContentItems=!0,n=n??"/api/content-items";let i={params:{per_page:this.perPage,_relationships:"helpCenterCollection",knowledge_base_id:this.knowledgeBaseId,parent_id:this.selectedNode&&this.selectedNode.id!=="all"?this.selectedNode.id:null}};this.hasSearchTerm&&(i.params.search=this.searchTerm),this.hasFilterExpressions&&(i.params._filters=this.filterExpressions.join("|")),this.hasSortingExpressions&&(i.params._sort=this.sortingExpressions.join("|"));const t=await S.get(n,i);this.pagination=t.data,this.contentItems=t.data.data||[],this.checkedRows=this.contentItems.reduce((l,c)=>(l[c.id]=!1,l),{})}catch(i){const t=((s=(e=i==null?void 0:i.response)==null?void 0:e.data)==null?void 0:s.message)||(i==null?void 0:i.message)||"Something went wrong while fetching content items";this.notificationState.showWarningNotification(t),console.error("Failed to fetch content items:",i)}finally{this.isLoadingContentItems=!1}},toggleTreeExpansion(){this.isTreeExpanded?(this.$refs.tree.collapseAll(),this.isTreeExpanded=!1):(this.$refs.tree.expandAll(),this.isTreeExpanded=!0)},updateTreeExpansionState(n){this.isTreeExpanded=n},toggleDraggable(){this.isDraggable=!this.isDraggable},async onUpdatePosition(n,e,s){console.log(this.treeNodes),console.log(s),this.treeNodes=s,console.log("onUpdatePosition"),console.log(`childId: ${n}`),console.log(`parentId: ${e}`),console.log(this.treeNodes)}},created(){this.fetchTreeNodes(),this.fetchContentItems()}},zs={class:"select-none space-y-4 sm:space-y-6"},Es={class:"flex justify-between"},Bs={class:"flex items-end space-x-2"},Fs={class:"flex justify-end space-x-2"},Ps={class:"flex space-x-4"},Us={class:"w-1/4 h-fit bg-white border border-gray-300 rounded-lg p-4"},js={class:"flex justify-between items-center mb-4"},Ls={class:"w-3/4"},Ds={class:"border-b border-indigo-200"},Os={scope:"col",class:"whitespace-nowrap align-center font-semibold px-4 py-2.5"},Rs={class:"whitespace-nowrap align-center px-4 py-4"},Hs={key:0,class:"whitespace-nowrap align-center pr-4 py-4"},qs={key:1,class:"whitespace-nowrap align-center pr-4 py-4"},Ws={key:0,class:"flex items-center space-x-1"},Js={key:1,class:"flex items-center space-x-1"},Gs={key:2,class:"flex items-center space-x-1"},Ks={key:3,class:"flex items-center space-x-1"},Zs={key:2,class:"whitespace-nowrap align-center pr-4 py-4"},Xs={key:0},Ys={key:1},Qs={key:1},$s={key:3,class:"whitespace-nowrap align-center pr-4 py-4"},eo={key:0},to={key:1},so={key:1},oo={key:4,class:"whitespace-nowrap align-center pr-4 py-4"},no={key:0},lo={key:1},io={key:1},ro={key:5,class:"whitespace-nowrap align-center pr-4 py-4"},ao={key:0},co={key:1},uo={class:"h-16 pr-4 py-4 flex align-middle items-center space-x-2"};function po(n,e,s,i,t,l){var H,q,W,J;const c=u("Folder"),p=u("Button"),m=u("Tree"),h=u("Breadcrumbs"),g=u("Dropdown"),k=u("Input"),E=u("FileText"),_=u("StickyNote"),B=u("Earth"),te=u("Pill"),L=u("Check"),se=u("Table"),oe=u("AddFolderModal"),ne=u("AddContentModal"),le=u("UpdateContentModal"),ie=u("DeleteContentModal"),de=u("DeleteContentsModal");return d(),a("div",zs,[o("div",Es,[o("div",Bs,[r(c,{size:"48","stroke-width":"1",class:"text-gray-400"}),e[1]||(e[1]=o("div",null,[o("h3",{class:"text-xl font-semibold text-gray-900 dark:text-white"},"Content"),o("p",{class:"text-sm text-gray-600 dark:text-neutral-400"}," Manage folders, articles, snippets, and webpages ")],-1))]),o("div",Fs,[r(p,{type:t.isDraggable?"primary":"light",size:"md",leftIcon:t.isDraggable?t.Lock:t.Unlock,leftIconSize:"20",action:l.toggleDraggable},{default:f(()=>[o("span",null,x(t.isDraggable?"Lock Position":"Unlock Position"),1)]),_:1},8,["type","leftIcon","action"]),r(p,{type:"light",size:"md",leftIcon:t.FolderPlus,leftIconSize:"20",action:l.showAddFolderModal},{default:f(()=>e[2]||(e[2]=[o("span",null,"New folder",-1)])),_:1},8,["leftIcon","action"]),r(p,{type:"primary",size:"md",leftIcon:t.Plus,leftIconSize:"20",action:l.showAddContentModal},{default:f(()=>e[3]||(e[3]=[o("span",null,"New content",-1)])),_:1},8,["leftIcon","action"])])]),o("div",Ps,[v(" Tree: "+x(t.treeNodes.map(b=>b.title))+" ",1),o("div",Us,[o("div",js,[e[4]||(e[4]=o("h3",{class:"text-lg font-medium text-gray-900"},"Folders",-1)),r(p,{size:"xs",type:"ghost",action:l.toggleTreeExpansion,leftIcon:t.isTreeExpanded?t.SquareMinus:t.SquarePlus},{default:f(()=>[o("span",null,x(t.isTreeExpanded?"Collapse All":"Expand All"),1)]),_:1},8,["action","leftIcon"])]),t.treeNodes.length?(d(),w(m,{key:0,ref:"tree",nodes:t.treeNodes,draggable:t.isDraggable,selectedNode:t.selectedNode,onNodeSelected:l.onNodeSelected,onOnChildAdd:l.onUpdatePosition,onUpdateExpansionState:l.updateTreeExpansionState},null,8,["nodes","draggable","selectedNode","onNodeSelected","onOnChildAdd","onUpdateExpansionState"])):y("",!0)]),o("div",Ls,[r(se,{onSearch:l.search,resource:"content-items",columns:t.columns,perPage:t.perPage,onPaginate:l.paginate,onRefresh:l.fetchContentItems,searchTerm:t.searchTerm,pagination:t.pagination,isLoading:t.isLoadingContentItems,onUpdatedColumns:l.updatedColumns,onUpdatedFilters:l.updatedFilters,onUpdatedSorting:l.updatedSorting,onUpdatedPerPage:l.updatedPerPage,filterExpressions:t.filterExpressions,sortingExpressions:t.sortingExpressions},{belowToolbar:f(()=>[r(h,{path:l.breadcrumbPath,action:l.onBreadcrumbClick,class:"border border-gray-300 rounded-lg py-2 px-4 mb-2"},null,8,["path","action"]),o("div",{class:C([{hidden:l.totalCheckedRows===0},"bg-gray-50 border flex items-center mb-2 p-4 rounded-lg shadow space-x-2"])},[e[5]||(e[5]=o("span",{class:"text-sm"},"Actions: ",-1)),r(g,{triggerSize:"sm",options:t.dropdownOptions,triggerText:`Select Action (${l.totalCheckedRows} selected)`},null,8,["options","triggerText"])],2)]),head:f(()=>[o("tr",Ds,[o("th",Os,[r(k,{type:"checkbox",modelValue:t.selectAll,"onUpdate:modelValue":e[0]||(e[0]=b=>t.selectAll=b),alignItems:"items-center"},null,8,["modelValue"])]),(d(!0),a(N,null,V(t.columns,(b,I)=>(d(),a(N,{key:I},[b.active?(d(),a("th",{key:0,scope:"col",class:C(["whitespace-nowrap align-top font-semibold pr-4 py-2.5",{"text-center":["Users"].includes(b.name)}])},x(b.name),3)):y("",!0)],64))),128)),e[6]||(e[6]=o("th",{scope:"col",class:"whitespace-nowrap align-top font-semibold pr-4 py-2.5"},"Actions",-1))])]),body:f(()=>[(d(!0),a(N,null,V(t.contentItems,b=>(d(),a("tr",{key:b.id,class:C([t.checkedRows[b.id]?"bg-blue-50":"bg-white hover:bg-gray-50","group cursor-pointer text-sm border-b border-gray-200"])},[o("td",Rs,[r(k,{type:"checkbox",alignItems:"items-center",modelValue:t.checkedRows[b.id],"onUpdate:modelValue":I=>t.checkedRows[b.id]=I},null,8,["modelValue","onUpdate:modelValue"])]),(d(!0),a(N,null,V(t.columns,(I,re)=>(d(),a(N,{key:re},[I.active?(d(),a(N,{key:0},[I.name=="Title"?(d(),a("td",Hs,[o("span",null,x(b.title),1)])):y("",!0),I.name=="Type"?(d(),a("td",qs,[r(te,{type:b.visibility==="public"?"primary":"light",size:"xs"},{default:f(()=>[o("span",null,[b.type==="folder"?(d(),a("span",Ws,[r(c,{size:"16"}),e[7]||(e[7]=o("span",null,"Folder",-1))])):b.type==="article"?(d(),a("span",Js,[r(E,{size:"16"}),o("span",null,x(b.visibility==="public"?"Public article":"Internal article"),1)])):b.type==="snippet"?(d(),a("span",Gs,[r(_,{size:"16"}),e[8]||(e[8]=o("span",null,"Snippet",-1))])):b.type==="webpage"?(d(),a("span",Ks,[r(B,{size:"16"}),e[9]||(e[9]=o("span",null,"Webpage",-1))])):y("",!0)])]),_:2},1032,["type"])])):y("",!0),I.name=="Copilot"?(d(),a("td",Zs,[b.type!=="folder"?(d(),a("div",Xs,[b.copilot_enabled?(d(),w(L,{key:0,size:"16",class:"text-green-500"})):(d(),a("div",Ys,""))])):(d(),a("div",Qs,""))])):y("",!0),I.name=="AI Agent"?(d(),a("td",$s,[b.type!=="folder"?(d(),a("div",eo,[b.ai_agent_enabled?(d(),w(L,{key:0,size:"16",class:"text-green-500"})):(d(),a("div",to,""))])):(d(),a("div",so,""))])):y("",!0),I.name=="Help Center"?(d(),a("td",oo,[b.type!=="folder"?(d(),a("div",no,[b.help_center_enabled?(d(),w(L,{key:0,size:"16",class:"text-green-500"})):(d(),a("div",lo,""))])):(d(),a("div",io,""))])):y("",!0),I.name=="Help Center collection"?(d(),a("td",ro,[b.help_center_collection?(d(),a("div",ao,x(b.help_center_collection.name),1)):(d(),a("div",co,""))])):y("",!0)],64)):y("",!0)],64))),128)),o("td",uo,[r(p,{type:"bare",size:"xs",leftIcon:t.Pencil,leftIconSize:"16",action:()=>l.showUpdateContentModal(b)},null,8,["leftIcon","action"]),r(p,{type:"bareDanger",size:"xs",leftIcon:t.Trash2,leftIconSize:"16",action:()=>l.showDeleteContentModal(b)},null,8,["leftIcon","action"])])],2))),128))]),_:1},8,["onSearch","columns","perPage","onPaginate","onRefresh","searchTerm","pagination","isLoading","onUpdatedColumns","onUpdatedFilters","onUpdatedSorting","onUpdatedPerPage","filterExpressions","sortingExpressions"])])]),r(oe,{ref:"addFolderModal",knowledgeBaseId:s.knowledgeBaseId,parentId:((H=t.selectedNode)==null?void 0:H.id)==="all"?null:(q=t.selectedNode)==null?void 0:q.id,treeNodes:t.treeNodes,selectedNode:t.selectedNode,onCreated:l.fetchTreeNodes},null,8,["knowledgeBaseId","parentId","treeNodes","selectedNode","onCreated"]),r(ne,{ref:"addContentModal",knowledgeBaseId:s.knowledgeBaseId,folderId:((W=t.selectedNode)==null?void 0:W.id)==="all"?null:(J=t.selectedNode)==null?void 0:J.id,treeNodes:t.treeNodes,selectedNode:t.selectedNode,onCreated:l.fetchContentItems},null,8,["knowledgeBaseId","folderId","treeNodes","selectedNode","onCreated"]),r(le,{ref:"updateContentModal",onUpdated:l.fetchContentItems},null,8,["onUpdated"]),r(ie,{ref:"deleteContentModal",onDeleted:l.onContentDeleted},null,8,["onDeleted"]),r(de,{ref:"deleteContentsModal",onDeleted:l.onContentsDeleted},null,8,["onDeleted"])])}const mo=A(Vs,[["render",po]]),ho={inject:["notificationState"],components:{Button:z,SourceManage:wt,ContentManage:mo,LibraryBig:be},props:{knowledgeBaseId:{type:String,required:!0}},data(){return{ArrowLeft:ye,knowledgeBase:null,currentTab:"Sources",tabs:[{name:"Sources",count:null},{name:"Content",count:null}]}},methods:{goBack(){this.$router.push({name:"show-knowledge-bases"})},async fetchKnowledgeBase(){var n,e;try{const s=await S.get(`/api/knowledge-bases/${this.knowledgeBaseId}`,{params:{_countable_relationships:"contentSources,contentItems"}});this.knowledgeBase=s.data,this.tabs.find(i=>i.name==="Sources").count=s.data.content_sources_count,this.tabs.find(i=>i.name==="Content").count=s.data.content_items_count}catch(s){const i=((e=(n=s==null?void 0:s.response)==null?void 0:n.data)==null?void 0:e.message)||(s==null?void 0:s.message)||"Something went wrong while fetching the knowledge base";this.notificationState.showWarningNotification(i),console.error("Failed to fetch knowledge base:",s)}}},created(){this.fetchKnowledgeBase()}},fo={class:"select-none min-h-screen bg-gray-50 pt-8 p-4 sm:p-8 space-y-4 sm:space-y-6"},go={class:"flex justify-between items-start"},bo={class:"flex items-end space-x-2"},yo={class:"text-xl font-semibold text-gray-900 dark:text-white"},xo={class:"border-b border-gray-200"},_o={class:"-mb-px flex space-x-8","aria-label":"Tabs"},wo=["onClick"],ko={key:0,class:"ml-1 text-xs"},vo={key:0},No={key:1};function Co(n,e,s,i,t,l){var g;const c=u("LibraryBig"),p=u("Button"),m=u("SourceManage"),h=u("ContentManage");return d(),a("div",fo,[o("div",go,[o("div",bo,[r(c,{size:"48","stroke-width":"1",class:"text-gray-400"}),o("div",null,[o("h2",yo,x(((g=t.knowledgeBase)==null?void 0:g.name)||"Knowledge Base"),1),e[0]||(e[0]=o("p",{class:"text-sm text-gray-600 dark:text-neutral-400"}," Manage sources and content for this knowledge base ",-1))])]),r(p,{type:"light",size:"sm",leftIcon:t.ArrowLeft,leftIconSize:"20",action:l.goBack},{default:f(()=>e[1]||(e[1]=[o("span",null,"Back to Knowledge Bases",-1)])),_:1},8,["leftIcon","action"])]),o("div",xo,[o("nav",_o,[(d(!0),a(N,null,V(t.tabs,k=>(d(),a("button",{key:k.name,onClick:E=>t.currentTab=k.name,class:C([t.currentTab===k.name?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm cursor-pointer"])},[v(x(k.name)+" ",1),k.count!==null?(d(),a("span",ko,"("+x(k.count)+")",1)):y("",!0)],10,wo))),128))])]),t.currentTab==="Sources"?(d(),a("div",vo,[r(m,{knowledgeBaseId:s.knowledgeBaseId},null,8,["knowledgeBaseId"])])):y("",!0),t.currentTab==="Content"?(d(),a("div",No,[r(h,{knowledgeBaseId:s.knowledgeBaseId},null,8,["knowledgeBaseId"])])):y("",!0)])}const Jo=A(ho,[["render",Co]]);export{Jo as default};
